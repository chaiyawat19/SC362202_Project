<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A-Frame: Find 5 Crystals</title>
  <link rel="icon" href="assets/icon.jpg">

  <!-- A-Frame and Component Libraries -->
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://unpkg.com/@c-frame/aframe-particle-system-component@1.2.x/dist/aframe-particle-system-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.0/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fern-solutions/aframe-sky-background/dist/sky-background.umd.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system/dist/aframe-physics-system.min.js"></script>
</head>
<body>
  <a-scene fog="type: exponential; color: #D0D0D0; density: 0.10">
    
    <!-- Assets -->
    <a-assets>
      <a-asset-item id="crystal1" src="assets/stylized_crystal (1).glb"></a-asset-item>
      <a-asset-item id="crystal2" src="assets/crystal (1).glb"></a-asset-item>
      <a-asset-item id="crystal3" src="assets/stylized_crystal.glb"></a-asset-item>
      <a-asset-item id="crystal4" src="assets/toon_style_-_crystal.glb"></a-asset-item>
      <a-asset-item id="crystal5" src="assets/magic_crystal.glb"></a-asset-item>
      <audio id="crystalSound" src="assets/Crystal Sound FX ï½œ Diamond Sound Effects [ FREE DOWNLOAD ].mp3"></audio>
      <audio id="crystalSound_loop" src="assets/Crystal Bar Chimes in note of A.mp3"></audio>
      <audio id="gateSound" src="assets/gate_openSound.m4a"></audio>
      <a-asset-item id="magic_gate" src="assets/a_door_in_the_glade.glb"></a-asset-item>
      <a-asset-item id="magic_house" src="assets/magic_house.glb"></a-asset-item>
    </a-assets>

    <!-- Camera with cursor -->
    <a-camera position="1 1.6 21">
      <a-cursor color="yellow"></a-cursor>
    </a-camera>

    <!-- Message and Interaction -->
    <a-entity gltf-model="#magic_house" position="4 0.5 15" rotation="0 -42.131 0">
      <a-text value="Find 5! Crystal to escape!!" color="#FFF" font="exo2bold" position="0 2 3" scale="2 2 2" align="center"></a-text>
    </a-entity>

    <a-text value="Mobile Web Application Development" color="#FFF" font="exo2bold" position="-1 3 18" scale="1.25 1.25 1.25" align="center"></a-text>
    <a-text value="SC362202" color="#FFF" font="exo2bold" position="-1 2.5 18" scale="1 1 1" align="center"></a-text>
    <a-text value="1.Natthapon Suwanampai 663380156-2" color="#FFF" font="exo2bold" position="-1.5 2 18" scale="0.8 0.8 0.8" align="center"></a-text>
    <a-text value="2.Natthaphan Chetwan 663380157-0" color="#FFF" font="exo2bold" position="-1.5 1.5 18" scale="0.8 0.8 0.8" align="center"></a-text>
    <a-text value="3.Chaiyawat Sonachai 663380195-2 " color="#FFF" font="exo2bold" position="-1.5 1 18" scale="0.8 0.8 0.8" align="center"></a-text>
    <a-text value="They make a sound (don't forget to turn on the speakers)." color="#fff" position="2 1.5 17.5" rotation="0 -42.131 0" scale="1 1 1" align="center"></a-text>

    <!-- Crystal Counter -->
    <a-entity id="crystalCounter" position="2 2 17.5" rotation="0 -42.131 0">
      <a-text value="Collected Crystals: 0 / 5" color="white" align="center" width="4"></a-text>
    </a-entity>

    <!-- Crystals -->
    <a-entity position="-10.5 3 -6" scale="2 1.5 0.1" >
      <a-text value="Easy one!" position="0 0 0" align="center" font="exo2bold"></a-text>
      <a-box position="0 0 -1" width="1.5" height="1" depth="1" color="#4CC3D9"></a-box>
    </a-entity>
    
    <a-entity gltf-model="#crystal1" position="40 1 -5" class="crystal" scale="0.5 0.5 0.5" animation="property: position; to: 40 3 -5; dir: alternate; dur: 2000; loop: true" material="emissive: #ff0000; emissiveIntensity: 3; transparent: true; opacity: 0.8">
      <a-light type="point" position="0 1.2 0" color="#3c40a5" intensity="10" distance="10"></a-light>
      <a-text value="Click me!" position="0 2 1" align="center"></a-text>
      <a-sound id="cryt1" src="#crystalSound_loop" position="0 0 0" autoplay="true" volume="1"></a-sound>
    </a-entity>

    <a-entity gltf-model="#crystal2" position="-10 1.2 -5" class="crystal" scale="1 1 1" material="emissive: #ff0000; emissiveIntensity: 3; transparent: true; opacity: 0.8" rotation="0 0 0" animation__rotate="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear">
      <a-text value="Click me!" position="0 0 1"></a-text>
      <a-light type="point" position="0 1.2 0" color="#3c40a5" intensity="10" distance="10"></a-light>
      <a-sound src="#crystalSound_loop" position="0 0 0" autoplay="true" volume="1"></a-sound>
    </a-entity>

    <a-entity gltf-model="#crystal3" position="8 1 50" class="crystal" scale="0.05 0.05 0.05" material="emissive: #ff0000; emissiveIntensity: 3; transparent: true; opacity: 0.8" rotation="0 0 0" animation__rotate="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear">
      <a-text value="Click me!" position="0 0 2"></a-text>
      <a-light type="point" position="0 1.2 0" color="#3c40a5" intensity="10" distance="10"></a-light>
      <a-sound src="#crystalSound_loop" position="0 0 0" autoplay="true" volume="1"></a-sound>
    </a-entity>

    <a-entity gltf-model="#crystal4" position="24 1 -40" class="crystal" scale="0.005 0.005 0.005" material="emissive: #ff0000; emissiveIntensity: 3; transparent: true; opacity: 0.8" rotation="0 0 0" animation__rotate="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear">
      <a-text value="Click me!" position="0 0 2"></a-text>
      <a-light type="point" position="0 1.2 0" color="#3c40a5" intensity="10" distance="10"></a-light>
      <a-sound src="#crystalSound_loop" position="0 0 0" autoplay="true" volume="1"></a-sound>
    </a-entity>

    <a-entity gltf-model="#crystal5" position="-50 1 0" class="crystal" scale="1 1 1" material="emissive: #ff0000; emissiveIntensity: 3; transparent: true; opacity: 0.8" rotation="0 0 0" animation__rotate="property: rotation; to: 0 360 0; dur: 10000; loop: true; easing: linear">
      <a-text value="Click me!" position="0 0 1"></a-text>
      <a-light type="point" position="0 1.2 0" color="#3c40a5" intensity="10" distance="10"></a-light>
      <a-sound src="#crystalSound_loop" position="0 0 0" autoplay="true" volume="1"></a-sound>
    </a-entity>

    <!-- Portal (Gate) -->
    <a-entity id="portal" visible="false">
      <a-entity gltf-model="#magic_gate" position="0 0 -10" scale="100 100 100"></a-entity>
      <a-text value="Go to Next Scene!" align="center" position="0 5.5 -10" color="white" scale="2 2 2" font="exo2bold"></a-text>
    </a-entity>

    <!-- Environment and Snow -->
    <a-entity environment="preset: goaland; grid: cross"></a-entity>
    <a-entity id="snow" particle-system="preset: snow; color: #24CAFF; particleCount: 5000"></a-entity>
    <a-sky-background top-color="#EBEBF5" bottom-color="#B9B9D2"></a-sky-background>
  </a-scene>

  <script>
    window.addEventListener('DOMContentLoaded', function () {
      let collected = 0;
      const crystalCounter = document.getElementById('crystalCounter').querySelector('a-text');
      const crystalSound = document.getElementById('crystalSound');
      const gateSound = document.getElementById('gateSound');
      const portal = document.getElementById('portal');

      // Add event listener for crystals
      document.querySelectorAll('.crystal').forEach(crystal => {
        crystal.setAttribute('data-collected', 'false');

        crystal.addEventListener('click', function () {
          if (this.getAttribute('data-collected') === 'false') {
            this.setAttribute('visible', false);
            this.setAttribute('data-collected', 'true');
            collected++;

            // Play crystal sound
            crystalSound.currentTime = 0;
            crystalSound.play();

            // Update crystal counter
            crystalCounter.setAttribute('value', `Collected Crystals: ${collected} / 5`);

            // Show portal if 5 crystals are collected
            if (collected === 5) {
              portal.setAttribute('visible', 'true');
              portal.setAttribute('material', 'opacity: 1');

              // Play gate opening sound
              gateSound.currentTime = 0;
              gateSound.play();
            }
          }
        });
      });

      // Add event listener for portal
      portal.addEventListener('click', function () {
        window.location.href = 'forest.html'; // Navigate to next scene
      });
    });
  </script>
</body>
</html>
